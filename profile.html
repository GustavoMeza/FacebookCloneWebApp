<html>

<head>
<title>Profile</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="styles.css">
<link rel="stylesheet" type="text/css" href="components/comment/style.css" />
<link rel="stylesheet" type="text/css" href="components/post/style.css" />
<script src="utils/requestHandler.js"></script>
<script src="utils/componentBuilder.js"></script>
<script src="components/avatar/controller.js"></script>
<script src="components/likesBanner/controller.js"></script>
<script src="components/comment/controller.js"></script>
<script src="components/commentComposer/controller.js"></script>
<script src="components/commentList/controller.js"></script>
<script src="components/post/controller.js"></script>
<script src="components/wall_/controller.js"></script>
</head>

<body>

    <div id="container">
    </div>

<script>

const params = new URLSearchParams(window.location.search);  
const userId = params.get("user"); 

let loadPage = () => { 
    let container = document.querySelector('#container');

    buildAvatar(userId)
        .then(avatarDOM => {
            container.appendChild(avatarDOM);
        });

    buildWall_(userId)
        .then(wallDOM => {
            container.appendChild(wallDOM);
        });

}

getFromApi('https://127.0.0.1:5001/Authentication/Validate')
    .then( res => {
        if(res.status == 401) {
            window.location.href = "http://127.0.0.1:8000/login.html";
        }
        return res.text();
    })
    .then(myId => {
        loadPage();
    });


</script>

</body>

</html>
